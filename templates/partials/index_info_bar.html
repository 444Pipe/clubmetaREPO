<!-- Index informational bar + mobile menu (now included site-wide) -->
<div id="indexInfoBar" class="index-info-bar" role="region" aria-label="Información principal">
  <div class="container d-flex align-items-center justify-content-between">
    <nav class="info-pills d-flex flex-wrap" aria-label="Información rápida" role="menubar">
      <div class="pill" data-dropdown role="none">
        <a href="#" role="menuitem" aria-haspopup="true" aria-expanded="false">Bienvenidos</a>
        <ul class="info-dropdown" role="menu">
          <li role="none"><a role="menuitem" href="{% url 'vision' %}">Visión</a></li>
          <li role="none"><a role="menuitem" href="{% url 'mision' %}">Misión</a></li>
          <li role="none"><a role="menuitem" href="{% url 'instalaciones' %}">Instalaciones</a></li>
        </ul>
      </div>
      <div class="pill" role="none"><a role="menuitem" href="{% url 'comunicados' %}">Comunicados de Gerencia</a></div>
      <div class="pill" role="none"><a role="menuitem" href="{% url 'junta_directiva' %}">Junta Directiva</a></div>
      <div class="pill" data-dropdown role="none">
        <a href="#" role="menuitem" aria-haspopup="true" aria-expanded="false">Deportes</a>
        <ul class="info-dropdown" role="menu">
          <li role="none"><a role="menuitem" href="{% url 'deportes_tenis' %}">Tenis</a></li>
          <li role="none"><a role="menuitem" href="{% url 'deportes_natacion' %}">Natación</a></li>
          <li role="none"><a role="menuitem" href="{% url 'deportes_futbol' %}">Fútbol</a></li>
          <li role="none"><a role="menuitem" href="{% url 'deportes_gimnasio' %}">Gimnasio</a></li>
        </ul>
      </div>
      <div class="pill" role="none"><a role="menuitem" href="{% url 'actividades' %}">Actividades</a></div>
      <div class="pill" data-dropdown role="none">
        <a href="#" role="menuitem" aria-haspopup="true" aria-expanded="false">Gastronomía</a>
        <ul class="info-dropdown" role="menu">
          <li role="none"><a role="menuitem" href="{% url 'gastronomia_salones' %}">Salones de eventos</a></li>
          <li role="none"><a role="menuitem" href="{% url 'gastronomia_refrigerios' %}">Menú Refrigerios Empresariales</a></li>
          <li role="none"><a role="menuitem" href="{% url 'gastronomia_eventos' %}">Menú Eventos Sociales</a></li>
          <li role="none"><a role="menuitem" href="{% url 'gastronomia_infantil' %}">Menú Infantil y Juvenil</a></li>
          <li role="none"><a role="menuitem" href="{% url 'gastronomia_pasabocas' %}">Pasabocas / Cóctel</a></li>
        </ul>
      </div>
      <div class="pill" role="none"><a role="menuitem" href="{% url 'administracion' %}">Administración</a></div>
    </nav>
  </div>
</div>

<!-- Mobile menu toggle (visible only on small screens) -->
<button id="mobileMenuToggle" class="mobile-menu-btn" aria-controls="mobileMenu" aria-expanded="false" aria-label="Abrir menú">Menú <span class="mobile-menu-icon">☰</span></button>

<!-- Mobile full-width slide-down menu -->
<div id="mobileMenuOverlay" class="mobile-menu-overlay" hidden></div>
<aside id="mobileMenu" class="mobile-menu" role="dialog" aria-label="Menú principal" aria-hidden="true">
  <div class="mobile-menu-inner">
    <nav class="mobile-nav" role="navigation">
      <ul>
        <li class="has-children">
          <button class="mobile-acc-btn" aria-expanded="false">Bienvenidos</button>
          <ul class="mobile-acc-panel">
            <li><a href="{% url 'vision' %}">Visión</a></li>
            <li><a href="{% url 'mision' %}">Misión</a></li>
            <li><a href="{% url 'instalaciones' %}">Instalaciones</a></li>
          </ul>
        </li>
        <li><a href="{% url 'comunicados' %}">Comunicados de Gerencia</a></li>
        <li><a href="{% url 'junta_directiva' %}">Junta Directiva</a></li>
        <li class="has-children">
          <button class="mobile-acc-btn" aria-expanded="false">Deportes</button>
          <ul class="mobile-acc-panel">
            <li><a href="{% url 'deportes_tenis' %}">Tenis</a></li>
            <li><a href="{% url 'deportes_natacion' %}">Natación</a></li>
            <li><a href="{% url 'deportes_futbol' %}">Fútbol</a></li>
            <li><a href="{% url 'deportes_gimnasio' %}">Gimnasio</a></li>
          </ul>
        </li>
        <li><a href="{% url 'actividades' %}">Actividades</a></li>
        <li class="has-children">
          <button class="mobile-acc-btn" aria-expanded="false">Gastronomía</button>
          <ul class="mobile-acc-panel">
            <li><a href="{% url 'gastronomia_salones' %}">Salones de eventos</a></li>
            <li><a href="{% url 'gastronomia_refrigerios' %}">Menú Refrigerios Empresariales</a></li>
            <li><a href="{% url 'gastronomia_eventos' %}">Menú Eventos Sociales</a></li>
            <li><a href="{% url 'gastronomia_infantil' %}">Menú Infantil y Juvenil</a></li>
            <li><a href="{% url 'gastronomia_pasabocas' %}">Pasabocas / Cóctel</a></li>
          </ul>
        </li>
        <li><a href="{% url 'administracion' %}">Administración</a></li>
      </ul>
    </nav>
  </div>
</aside>

<style>
  /* More serious, compact visual: no margins between pills */
  .index-info-bar { background: linear-gradient(180deg,#15306f,#1e3a8a); color: #fff; padding: 0.35rem 0; box-shadow: 0 6px 18px rgba(0,0,0,0.14); position: relative; z-index: 1100; }
  .index-info-bar .info-pills { gap: 0.25rem; display: flex; align-items: center; }
  .index-info-bar .pill { position: relative; margin: 0; }
  .index-info-bar .pill > a { display: inline-block; padding: 0.45rem 0.6rem; background: transparent; color: #fff; border-radius: 0; text-decoration: none; font-weight: 700; font-size: 0.95rem; text-transform: uppercase; letter-spacing: 0.6px; }
  .index-info-bar .pill + .pill > a { margin-left: 0.9rem; }
  .index-info-bar .pill:hover > a, .index-info-bar .pill:focus-within > a { color: rgba(255,255,255,0.95); text-decoration: none; border-bottom: 2px solid rgba(255,255,255,0.12); padding-bottom: 2px; }
  .index-info-bar .pill:first-child > a { font-weight: 800; }
  .index-info-bar .info-dropdown { display: none; position: absolute; top: calc(100% + 6px); left: 50%; transform: translateX(-50%); min-width: 220px; background: #ffffff; color: #07203a; padding: 0.45rem 0.25rem; border-radius: 10px; list-style: none; box-shadow: 0 10px 30px rgba(9,30,66,0.12); border: 1px solid rgba(9,30,66,0.06); }
  .index-info-bar .info-dropdown li { text-align: center; padding: 0; }
  .index-info-bar .info-dropdown li a { color: #07203a; text-decoration: none; display: block; padding: 0.45rem 0.9rem; font-weight: 600; border-radius: 8px; }
  .index-info-bar .info-dropdown li a:hover, .index-info-bar .info-dropdown li a:focus { background: rgba(6, 54, 120, 0.06); color: #07203a; outline: none; }
  .index-info-bar .info-dropdown li a.selected { background: rgba(6, 54, 120, 0.12); color: #07203a; }
  .index-info-bar .pill[data-dropdown]:hover .info-dropdown, .index-info-bar .pill[data-dropdown].open .info-dropdown { display: block; }

  @media (max-width: 992px) {
    .index-info-bar .info-pills { overflow-x: auto; -webkit-overflow-scrolling: touch; padding-bottom: 0.25rem; gap: 0.75rem; }
    .index-info-bar .info-dropdown { position: static; transform: none; margin-top: 0.35rem; left: auto; }
    .index-info-bar .pill > a { padding: 0.6rem 0.75rem; font-size: 1rem; }
  }

  @media (max-width: 768px) {
    .index-info-bar { position: static; padding-top: calc(env(safe-area-inset-top, 0) + 0.25rem); }
    .index-info-bar .container { padding-left: 0.5rem; padding-right: 0.5rem; }
    .index-info-bar .info-pills { flex-direction: column; align-items: stretch; gap: 0; overflow: visible; }
    .index-info-bar .pill { width: 100%; border-bottom: 1px solid rgba(255,255,255,0.04); }
    .index-info-bar .pill > a { display: block; width: 100%; padding: 0.9rem 0.5rem; font-size: 1.02rem; text-align: left; color: #fff; }
    .index-info-bar .pill + .pill > a { margin-left: 0; }
    .index-info-bar .info-dropdown { display: none; position: static; transform: none; background: rgba(255,255,255,0.06); margin: 0; padding: 0.25rem 0; border-radius: 6px; }
    .index-info-bar .info-dropdown li a { padding: 0.65rem 0.9rem; color: #fff; }
    .index-info-bar .pill.open > .info-dropdown { display: block; }
    .index-info-bar .pill .info-dropdown { box-shadow: none; }
    .index-info-bar .pill:first-child > a { padding-top: 0.65rem; }
    .index-info-bar { z-index: 2000; }
    .index-info-bar { display: none; }
  }

  /* Mobile menu button and panel */
  .mobile-menu-btn { display: none; position: absolute; right: 1rem; top: calc(env(safe-area-inset-top, 0) + 16px); background: transparent; color: #fff; border: none; font-weight: 700; padding: 0.4rem 0.6rem; font-size: 1rem; display:flex; align-items:center; gap:8px; }
  .mobile-menu-icon { display:inline-block; margin-left:4px; font-size:1.15rem; line-height:1; }
  .mobile-menu-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.35); z-index: 1999; display:block; }
  .mobile-menu { position: fixed; inset: 0 0 auto 0; background: linear-gradient(180deg,#15306f,#1e3a8a); transform: translateY(-110%); transition: transform .28s cubic-bezier(.2,.9,.3,1); z-index: 2000; }
  .mobile-menu.open { transform: translateY(0); }
  .mobile-menu-inner { padding: calc(env(safe-area-inset-top, 0) + 1rem) 1rem 1rem; }
  .mobile-nav ul { list-style: none; margin: 0; padding: 0; }
  .mobile-nav a, .mobile-acc-btn { display:block; color:#fff; text-decoration:none; padding: 0.9rem 0; font-weight:700; border-bottom:1px solid rgba(255,255,255,0.04); text-transform:uppercase; }
  .mobile-acc-btn { background: transparent; border: none; width:100%; text-align:left; }
  .mobile-acc-panel { display:none; padding-left: 0.6rem; background: rgba(255,255,255,0.02); }
  .mobile-acc-panel li a { padding: 0.9rem 0.5rem; font-weight:600; text-transform:none; color: rgba(255,255,255,0.95); display:block; }
  .mobile-acc-panel li a:hover, .mobile-acc-panel li a:focus { background: rgba(255,255,255,0.03); }
  .mobile-acc-panel li a.selected { background: rgba(255,255,255,0.05); color: #fff; }
  .mobile-acc-btn[aria-expanded='true'] + .mobile-acc-panel { display:block; }

  @media (max-width: 768px) {
    .mobile-menu-btn { display: inline-block; }
    .index-info-bar .info-pills { display: none; }
  }
</style>

<script>
  (function(){
    try{
      document.addEventListener('click', function(e){
        var clickedPill = e.target.closest('.pill[data-dropdown]');
        var anyPill = document.querySelectorAll('.pill[data-dropdown]');
        anyPill.forEach(function(p){ if (p !== clickedPill) { p.classList.remove('open'); p.querySelector('a[aria-expanded]') && p.querySelector('a[aria-expanded]').setAttribute('aria-expanded','false'); } });
        if (clickedPill) {
          var btn = clickedPill.querySelector('a[aria-expanded]');
          var willOpen = !clickedPill.classList.contains('open');
          clickedPill.classList.toggle('open');
          if (btn) btn.setAttribute('aria-expanded', willOpen ? 'true' : 'false');
        }
      });

      document.addEventListener('keydown', function(e){ if (e.key === 'Escape') document.querySelectorAll('.pill[data-dropdown].open').forEach(function(p){ p.classList.remove('open'); p.querySelector('a[aria-expanded]') && p.querySelector('a[aria-expanded]').setAttribute('aria-expanded','false'); }); });

      document.querySelectorAll('.info-pills [role="menuitem"]').forEach(function(item){
        item.addEventListener('keydown', function(e){
          var key = e.key;
          if (key === 'ArrowRight' || key === 'Right') { e.preventDefault(); var next = item.closest('.pill').nextElementSibling; if (next) next.querySelector('[role="menuitem"]').focus(); }
          if (key === 'ArrowLeft' || key === 'Left') { e.preventDefault(); var prev = item.closest('.pill').previousElementSibling; if (prev) prev.querySelector('[role="menuitem"]').focus(); }
          if (key === 'Enter' || key === ' ') { var parent = item.closest('.pill'); if (parent && parent.matches('[data-dropdown]')) { e.preventDefault(); item.click(); } }
        });
      });

      document.querySelectorAll('.pill[data-dropdown] > a').forEach(function(btn){
        var startX=0, startY=0, moved=false;
        btn.addEventListener('touchstart', function(ev){ moved = false; var t = ev.touches && ev.touches[0]; if (t) { startX = t.clientX; startY = t.clientY; } }, {passive:true});

        btn.addEventListener('touchmove', function(ev){ var t = ev.touches && ev.touches[0]; if (!t) return; var dx = Math.abs(t.clientX - startX); var dy = Math.abs(t.clientY - startY); if (dy > 10 && dy > dx) moved = true; }, {passive:true});

        btn.addEventListener('touchend', function(ev){ if (moved) return; var p = btn.closest('.pill'); var opened = p.classList.contains('open'); document.querySelectorAll('.pill[data-dropdown]').forEach(function(x){ if (x !== p) { x.classList.remove('open'); x.querySelector('a[aria-expanded]') && x.querySelector('a[aria-expanded]').setAttribute('aria-expanded','false'); } }); p.classList.toggle('open'); btn.setAttribute('aria-expanded', opened ? 'false' : 'true'); ev.preventDefault(); }, {passive:false});
      });

      document.addEventListener('click', function(e){ if (!e.target.closest('.index-info-bar')) { document.querySelectorAll('.pill[data-dropdown].open').forEach(function(p){ p.classList.remove('open'); p.querySelector('a[aria-expanded]') && p.querySelector('a[aria-expanded]').setAttribute('aria-expanded','false'); }); } });

      var mobileToggle = document.getElementById('mobileMenuToggle');
      var mobileMenu = document.getElementById('mobileMenu');
      var mobileOverlay = document.getElementById('mobileMenuOverlay');
      function openMobileMenu(){ if (!mobileMenu) return; mobileMenu.classList.add('open'); mobileMenu.setAttribute('aria-hidden','false'); mobileOverlay.hidden = false; mobileToggle.setAttribute('aria-expanded','true'); var first = mobileMenu.querySelector('a, button'); if (first) first.focus(); }
      function closeMobileMenu(){ if (!mobileMenu) return; mobileMenu.classList.remove('open'); mobileMenu.setAttribute('aria-hidden','true'); mobileOverlay.hidden = true; mobileToggle.setAttribute('aria-expanded','false'); mobileToggle.setAttribute('aria-expanded','false'); mobileToggle.focus(); }
      if (mobileToggle){ mobileToggle.addEventListener('click', function(e){ if (mobileMenu && mobileMenu.classList.contains('open')) closeMobileMenu(); else openMobileMenu(); }); }
      if (mobileOverlay){ mobileOverlay.addEventListener('click', closeMobileMenu); }
      document.addEventListener('keydown', function(e){ if (e.key === 'Escape') { closeMobileMenu(); } });

      document.querySelectorAll('.mobile-acc-btn').forEach(function(b){ b.addEventListener('click', function(){ var expanded = b.getAttribute('aria-expanded') === 'true'; b.setAttribute('aria-expanded', expanded ? 'false' : 'true'); }); });

      document.querySelectorAll('.info-dropdown a').forEach(function(link){ link.addEventListener('click', function(ev){ document.querySelectorAll('.info-dropdown a.selected').forEach(function(s){ s.classList.remove('selected'); }); link.classList.add('selected'); var p = link.closest('.pill[data-dropdown]'); if (p) { p.classList.remove('open'); var btn = p.querySelector('a[aria-expanded]'); if (btn) btn.setAttribute('aria-expanded','false'); } }); });

      document.querySelectorAll('#mobileMenu a').forEach(function(m){ m.addEventListener('click', function(){ document.querySelectorAll('#mobileMenu a.selected').forEach(function(s){ s.classList.remove('selected'); }); m.classList.add('selected'); setTimeout(function(){ closeMobileMenu(); }, 160); }); });

    }catch(err){ console.warn(err); }
  })();
</script>
