{% extends 'base.html' %}
{% load static %}
{% block title %}Nuestro Menú - CLUB EL META{% endblock %}
{% block content %}
<div class="container py-5">
  <h1 class="mb-3">Nuestro Menú</h1>
  <p class="fs-5">Presentamos una selección representativa de opciones gastronómicas disponibles para eventos y consumo en el club. Para consultar el menú completo y solicitar cotización, por favor contacta al restaurante: <a href="tel:+573108824473">310 882 4473</a>.</p>
  <p class="mt-3">Para consultar el menú completo y solicitar cotización, contacta al restaurante: <a href="tel:+573108824473">310 882 4473</a>.</p>

  <h2 class="mt-4">Galería del Menú</h2>

  <div class="menu-toolbar d-flex gap-2 align-items-center mt-3">
    <button id="btn-print" class="btn btn-outline-primary btn-sm">Imprimir / Guardar como PDF</button>
    <button id="btn-fit" class="btn btn-outline-secondary btn-sm">Ajustar ancho</button>
    <button id="btn-first" class="btn btn-outline-secondary btn-sm">Primera página</button>
    <button id="btn-prev" class="btn btn-outline-secondary btn-sm">Anterior</button>
    <button id="btn-next" class="btn btn-outline-secondary btn-sm">Siguiente</button>
    <div class="ms-auto text-muted small">Usa flecha arriba/abajo o PageUp/PageDown</div>
  </div>

  <div class="menu-stack mt-3" id="menuStack">
    <div class="menu-page" data-page="1"><img src="{% static 'img/menu/menu1.jpeg' %}" alt="Menú 1"><div class="page-label">Página 1</div></div>
    <div class="menu-page" data-page="2"><img src="{% static 'img/menu/menu2.jpeg' %}" alt="Menú 2"><div class="page-label">Página 2</div></div>
    <div class="menu-page" data-page="3"><img src="{% static 'img/menu/menu3.jpeg' %}" alt="Menú 3"><div class="page-label">Página 3</div></div>
    <div class="menu-page" data-page="4"><img src="{% static 'img/menu/menu4.jpeg' %}" alt="Menú 4"><div class="page-label">Página 4</div></div>
    <div class="menu-page" data-page="5"><img src="{% static 'img/menu/menu5.jpeg' %}" alt="Menú 5"><div class="page-label">Página 5</div></div>
    <div class="menu-page" data-page="6"><img src="{% static 'img/menu/menu6.jpeg' %}" alt="Menú 6"><div class="page-label">Página 6</div></div>
    <div class="menu-page" data-page="7"><img src="{% static 'img/menu/menu7.jpeg' %}" alt="Menú 7"><div class="page-label">Página 7</div></div>
    <div class="menu-page" data-page="8"><img src="{% static 'img/menu/menu8.jpeg' %}" alt="Menú 8"><div class="page-label">Página 8</div></div>
    <div class="menu-page" data-page="9"><img src="{% static 'img/menu/menu9.jpeg' %}" alt="Menú 9"><div class="page-label">Página 9</div></div>
  </div>

</div>
{% endblock %}

{% block extra_css %}
<style>
  /* Stacked pages so user can scroll top-to-bottom like a PDF */
  .menu-stack { display: flex; flex-direction: column; gap: 1rem; align-items: center; }
  .menu-page { width: 100%; max-width: 980px; box-shadow: 0 6px 24px rgba(10,10,10,0.06); border-radius: 8px; overflow: hidden; background: #fff; }
  .menu-page img { width: 100%; height: auto; display: block; }
  @media (max-width: 576px) {
    .menu-page { max-width: 100%; }
  }
  /* Toolbar */
  .menu-toolbar { position: sticky; top: 88px; z-index: 40; background: rgba(255,255,255,0.85); padding: 0.4rem; border-radius: 10px; box-shadow: 0 6px 20px rgba(0,0,0,0.06); }
  .menu-toolbar .btn { min-width: 110px; }

  /* Page label */
  .page-label { position: absolute; right: 12px; bottom: 12px; background: rgba(0,0,0,0.6); color: #fff; padding: 6px 10px; border-radius: 6px; font-size: 0.9rem; }

  /* Fit width mode */
  .fit-width .menu-page { max-width: 100% !important; border-radius: 0; }
</style>
{% endblock %}
{% block extra_js %}
<script>
  (function(){
    const pages = Array.from(document.querySelectorAll('.menu-page'));
    let idx = 0;
    function scrollToIndex(i){
      i = Math.max(0, Math.min(pages.length-1, i));
      idx = i;
      pages[idx].scrollIntoView({behavior:'smooth', block:'start'});
    }

    document.getElementById('btn-next').addEventListener('click', ()=> scrollToIndex(idx+1));
    document.getElementById('btn-prev').addEventListener('click', ()=> scrollToIndex(idx-1));
    document.getElementById('btn-first').addEventListener('click', ()=> scrollToIndex(0));
    document.getElementById('btn-fit').addEventListener('click', ()=> document.body.classList.toggle('fit-width'));
    document.getElementById('btn-print').addEventListener('click', ()=> window.print());

    // Keyboard navigation
    window.addEventListener('keydown', (e)=>{
      if(['ArrowDown','PageDown'].includes(e.key)) { e.preventDefault(); scrollToIndex(idx+1); }
      if(['ArrowUp','PageUp'].includes(e.key)) { e.preventDefault(); scrollToIndex(idx-1); }
      if(e.key==='Home'){ e.preventDefault(); scrollToIndex(0); }
      if(e.key==='End'){ e.preventDefault(); scrollToIndex(pages.length-1); }
    });

    // Update idx while scrolling (approximate)
    let ticking=false;
    window.addEventListener('scroll', ()=>{
      if(ticking) return; ticking=true;
      requestAnimationFrame(()=>{
        const mid = window.innerHeight/4 + window.scrollY;
        let nearest = 0; let minDist = Infinity;
        pages.forEach((p,i)=>{
          const rect = p.getBoundingClientRect();
          const top = rect.top + window.scrollY;
          const dist = Math.abs(top - mid);
          if(dist < minDist){ minDist = dist; nearest = i; }
        });
        idx = nearest;
        ticking=false;
      });
    });
  })();
</script>
{% endblock %}

